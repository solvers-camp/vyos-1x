name: Check for unused imports using Pylint
on:
  pull_request:
    branches:
      - current

permissions:
  pull-requests: write
  contents: read

jobs:
  check-unused-imports:
    # uses: vyos/.github/.github/workflows/check-unused-imports.yml@current
    uses: solvers-camp/.github/.github/workflows/check-unused-imports.yml@main
    secrets: inherit

  add-pr-comment:
    needs: check-unused-imports
    runs-on: ubuntu-latest
    steps:
      - name: Checkout pull request head
        uses: actions/checkout@v3
        with:
          ref: ${{ github.event.pull_request.head.ref }}
          repository: ${{ github.event.pull_request.head.repo.full_name }}

      - name: Add PR comment
        uses: mshick/add-pr-comment@v2
        with:
          message: |-
            ${{ needs.check-unused-imports.outputs.error_message == 'No issues in unused-imports' && 'üëç' || '‚ùå' }}
            ${{ needs.check-unused-imports.outputs.error_message }}
          message-id: "UNUSED_IMPORTS_VALIDATION"
          allow-repeats: false
